
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Epiphan Cloud Developer's Guide</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#big-picture" class="toc-h1 toc-link" data-title="Big picture">Big picture</a>
          </li>
          <li>
            <a href="#authorization" class="toc-h1 toc-link" data-title="Authorization">Authorization</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#issuing-a-token" class="toc-h2 toc-link" data-title="Issuing a token">Issuing a token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#getting-all-devices" class="toc-h1 toc-link" data-title="Getting All Devices">Getting All Devices</a>
          </li>
          <li>
            <a href="#getting-a-specific-device" class="toc-h1 toc-link" data-title="Getting a Specific Device">Getting a Specific Device</a>
          </li>
          <li>
            <a href="#pairing-a-real-device" class="toc-h1 toc-link" data-title="Pairing a Real Device">Pairing a Real Device</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#switching-the-webcaster-x2-device-to-av-studio-mode" class="toc-h2 toc-link" data-title="Switching the Webcaster X2 Device to Epiphan Cloud Mode">Switching the Webcaster X2 Device to Epiphan Cloud Mode</a>
                  </li>
                  <li>
                    <a href="#pairing-the-device" class="toc-h2 toc-link" data-title="Pairing the Device">Pairing the Device</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#device-commands" class="toc-h1 toc-link" data-title="Device Commands">Device Commands</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#sending-commands-to-devices" class="toc-h2 toc-link" data-title="Sending Commands to Devices">Sending Commands to Devices</a>
                  </li>
                  <li>
                    <a href="#setparam" class="toc-h2 toc-link" data-title="setparam:">setparam:</a>
                  </li>
                  <li>
                    <a href="#recording-start-stop" class="toc-h2 toc-link" data-title="recording.start/stop">recording.start/stop</a>
                  </li>
                  <li>
                    <a href="#afu-start-stop" class="toc-h2 toc-link" data-title="afu.start/stop">afu.start/stop</a>
                  </li>
                  <li>
                    <a href="#footage-clear" class="toc-h2 toc-link" data-title="footage.clear">footage.clear</a>
                  </li>
                  <li>
                    <a href="#rtmp-start-url" class="toc-h2 toc-link" data-title="rtmp.start:url">rtmp.start:url</a>
                  </li>
                  <li>
                    <a href="#rtmp-stop" class="toc-h2 toc-link" data-title="rtmp.stop">rtmp.stop</a>
                  </li>
                  <li>
                    <a href="#firmware-update" class="toc-h2 toc-link" data-title="firmware.update">firmware.update</a>
                  </li>
                  <li>
                    <a href="#unpair" class="toc-h2 toc-link" data-title="unpair">unpair</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#recording" class="toc-h1 toc-link" data-title="Recording">Recording</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#recorded-footage-on-device" class="toc-h2 toc-link" data-title="Recorded Footage on Device">Recorded Footage on Device</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#getting-recordings" class="toc-h1 toc-link" data-title="Getting Recordings">Getting Recordings</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getting-list-of-uploaded-chunks" class="toc-h2 toc-link" data-title="Getting List of Uploaded Chunks">Getting List of Uploaded Chunks</a>
                  </li>
                  <li>
                    <a href="#downloading-chunks" class="toc-h2 toc-link" data-title="Downloading Chunks">Downloading Chunks</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://go.epiphancloud.com'>epiphancloud.com</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Epiphan Cloud API! You can use our API to pair, control and monitor Epiphan devices.</p>

<p>We have language bindings in bash and Python. You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>
<h1 id='big-picture'>Big picture</h1>
<p>Each encoder device has a long poll connection to Epiphan Cloud and waits for commands. Initially, all devices are <em>unpaired</em>, which means that they are not associated with any Epiphan Cloud account. To pair a device, log in to your Epiphan Cloud account and send a pairing command to Epiphan Cloud using the pairing code. Epiphan Cloud finds the device that has this code and connects your account to it.</p>
<h1 id='authorization'>Authorization</h1><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/users/me <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">api</span> <span class="o">=</span> <span class="n">EpiphanCloudAPI2</span><span class="p">()</span>
<span class="n">api</span><span class="o">.</span><span class="n">setAuthToken</span><span class="p">(</span><span class="n">TOKEN</span><span class="p">)</span>
</code></pre>
<p>Epiphan Cloud uses bearer token authorization (<a href="https://tools.ietf.org/html/rfc6750">rfc6750</a>). HTTP API requests must include auth token in their HTTP headers: </p>

<p><code>Authorization: Bearer &lt;TOKEN&gt;</code></p>
<h2 id='issuing-a-token'>Issuing a token</h2>
<p>Tokens are issued in &quot;Integrations&quot; tab in your Epiphan Cloud team settings:</p>

<p><video width="100%" height="auto" src="images/new_token.mp4" controls/></p>

<p>Few notes about tokens:</p>

<ul>
<li><p>Tokens can be issued by the team&#39;s owner or admin. Multiple tokens can be issued for a team, but each token is linked to one team.</p></li>
<li><p>Tokens have admin permissions, without access to tokens and user management functionality.</p></li>
<li><p>Tokens do not expire.</p></li>
</ul>
<h1 id='getting-all-devices'>Getting All Devices</h1>
<p>There&#39;re two devices in a newly created Epiphan Cloud account, let&#39;s retrieve them:</p>
<pre class="highlight python tab-python"><code><span class="n">devices</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get_all</span><span class="p">()</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">d</span><span class="p">[</span><span class="s">"Id"</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s">"Name"</span><span class="p">]</span>

<span class="c"># Output:</span>
<span class="c"># demo_0_d3d68f3c My First Demo Device</span>
<span class="c"># demo_1_4e0a964a-b350-435f-82c9-de6ab5188af2 My Second Demo Device</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices <span class="se">\</span>
    -H <span class="s2">"Authorization: Bearer TOKEN"</span>
</code></pre>
<blockquote>
<p>The above command returns array with the device info dictionaries:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo_0_d3d68f3c"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My First Demo Device"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Model"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Demo"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Online"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Recording"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"StateTime"</span><span class="p">:</span><span class="w"> </span><span class="mf">1539366714.931</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SnapshotURL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/front/api/v1/devices/demo_0_d3d68f3c/state.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"IsUnpaired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Telemetry"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><code>GET /front/api/v2/devices</code></p>
<h1 id='getting-a-specific-device'>Getting a Specific Device</h1><pre class="highlight python tab-python"><code><span class="n">device</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"demo_0_d3d68f3c"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices/demo_0_d3d68f3c <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo_0_d3d68f3c"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My First Demo Device"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Model"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Demo"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Online"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Recording"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"StateTime"</span><span class="p">:</span><span class="w"> </span><span class="mf">1539366714.931</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SnapshotURL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/front/api/v1/devices/demo_0_d3d68f3c/state.jpg"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"IsUnpaired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Telemetry"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><code>GET /front/api/v2/devices/DEVICEID</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>DEVICEID</td>
<td>The ID of the device to retrieve</td>
</tr>
</tbody></table>
<h1 id='pairing-a-real-device'>Pairing a Real Device</h1>
<p>Let&#39;s pair a real device.</p>
<h3 id='switching-the-webcaster-x2-device-to-av-studio-mode'>Switching the Webcaster X2 Device to Epiphan Cloud Mode</h3>
<p>There are two ways to switch modes:</p>

<p>Double press the power button on the device until the LCD screen shows Epiphan logo:</p>

<p><img src="images/front_screen_pairing_code.jpg" title="Swtiching to Epiphan Cloud using LCD screen" alt="Swtiching to Epiphan Cloud using LCD screen" /></p>

<p>Or select Epiphan Cloud using a monitor and attached USB mouse:</p>

<p><img src="images/switch_to_epiphancloud.gif" title="Swtiching to Epiphan Cloud using a monitor and a mouse" alt="Swtiching to Epiphan Cloud using a monitor and a mouse" /></p>
<h3 id='pairing-the-device'>Pairing the Device</h3>
<p>To pair a device we use the following endpoint:</p>

<p><code>POST /front/api/v2/devices</code></p>
<pre class="highlight python tab-python"><code><span class="n">r</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">"5cf06c29"</span><span class="p">,</span> <span class="s">"NEW DEVICE"</span><span class="p">)</span>
<span class="n">device_id</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s">"ID"</span><span class="p">]</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl -X POST https://go.epiphancloud.com/front/api/v2/devices <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  -d <span class="s1">'{"DeviceID": "5cf06c29", "Name": "NEW DEVICE"}'</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"StatusCode"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEVICEID"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h1 id='device-commands'>Device Commands</h1><h2 id='sending-commands-to-devices'>Sending Commands to Devices</h2>
<blockquote>
<p>e.g. setting bitrate to 1 Mbit/s:</p>
</blockquote>
<pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"setparam:bitrate=1000"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "setparam:bitrate=1000"}'</span>
</code></pre>
<p>To send commands to devices, POST <code>{&quot;cmd&quot;: COMMAND}</code> json to this endpoint:</p>

<p><code>POST front/api/v2/devices/DEVICEID/task</code></p>
<h2 id='setparam'>setparam:</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deviceId</span><span class="p">)[</span><span class="s">"Telemetry"</span><span class="p">][</span><span class="s">"settings"</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="c"># Output: ['resolution', 'bitrate']</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
| jq <span class="s1">'.Telemetry.settings | keys'</span>

<span class="c"># Output:</span>
<span class="c"># [</span>
<span class="c">#   "bitrate",</span>
<span class="c">#   "resolution"</span>
<span class="c"># ]</span>
</code></pre>
<p>This command sets the value of the device settings parameter. Available parameters are listed in the device info Telemetry/settings dictionary.</p>

<p>Epiphan Webcaster X2&#39;s support the following parameters:</p>

<table><thead>
<tr>
<th>Param</th>
<th>Possible values</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>resolution</td>
<td>1920x1080, 1280x720, 640x360, 320x180</td>
<td>Stream frame size</td>
</tr>
<tr>
<td>bitrate</td>
<td>up to 4000</td>
<td>Stream bitrate, in Kbit/s</td>
</tr>
<tr>
<td>chunk_duration</td>
<td>10-3600</td>
<td>Chunk duration, in seconds</td>
</tr>
</tbody></table>
<h2 id='recording-start-stop'>recording.start/stop</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"recording.start"</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"recording.stop"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "recording.start"}'</span>

 curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "recording.stop"}'</span>
</code></pre>
<p>These commands start and stop recording. See &quot;<a href="/#recording">Recording</a>&quot; section for details.</p>
<h2 id='afu-start-stop'>afu.start/stop</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"afu.start"</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"afu.stop"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "afu.start"}'</span>

 curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "afu.stop"}'</span>
</code></pre>
<p>These commands start and stop uploading the recording footage to Epiphan Cloud. See &quot;<a href="/#recording">Recording</a>&quot; section for details.</p>
<h2 id='footage-clear'>footage.clear</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"footage.clear"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "footage.clear"}'</span>
</code></pre>
<p>This command deletes recorded footage on the device (the footage that is not uploaded yet). See &quot;<a href="/#recording">Recording</a>&quot; section for details.</p>
<h2 id='rtmp-start-url'>rtmp.start:url</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"rtmp.start:rtmp://10.1.2.16/live/test"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "rtmp.start:rtmp://10.1.2.16/live/test"}'</span>
</code></pre>
<blockquote>
<p>The status of the RTMP stream is reported in <code>Telemetry/state/rtmp</code>.</p>

<p><code>speed</code> is actual_uploading_speed/bitrate ratio, values greater or equal to 1.0 are ok, less than 1.0 means there&#39;s not enough bandwidth.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="s2">"rtmp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rtmp://10.1.2.16/live/test"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"speed"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.00</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bitrate"</span><span class="p">:</span><span class="w"> </span><span class="mi">2061</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sent"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"frames"</span><span class="p">:</span><span class="w"> </span><span class="mi">896</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"bytes"</span><span class="p">:</span><span class="w"> </span><span class="mi">7723008</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This command starts an RTMP stream to a given RTMP url.</p>
<h2 id='rtmp-stop'>rtmp.stop</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"rtmp.stop"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "rtmp.stop"}'</span>
</code></pre>
<p>To stop the RTMP stream that was started by <code>rtmp.start</code></p>
<h2 id='firmware-update'>firmware.update</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"firmware.update"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "firmware.update"}'</span>
</code></pre>
<p>Starts a firmware update if a more recent firmware version is available.</p>
<h2 id='unpair'>unpair</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">run_command</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="s">"unpair"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code> curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/task <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
  --data-binary <span class="s1">'{"cmd": "unpair"}'</span>
</code></pre>
<p>Unpairs the device from the account that it&#39;s paired to.</p>
<h1 id='recording'>Recording</h1>
<p>Webcaster X2 devices can record footage and upload it to the Epiphan Cloud account, to which they are paired.</p>

<p>On Webcaster X2 stream is recorded to SD card, or internal flash memory, if SD card is full or is not available.</p>

<p>Recorder is started by <code>recording.start</code> and stopped by <code>recording.stop</code> commands. If uploading is enabled by <code>afu.start</code> command, it gets uploaded to Epiphan Cloud and deleted from device storage.</p>

<p>If uploading is disabled by <code>afu.stop</code> command, footage stays on device, until it&#39;s deleted by <code>footage.clear</code> command, or uploading is started.</p>

<p>Recording, streaming and uploading can run at the same time.</p>

<p>The footage, uploaded to Epiphan Cloud, is billed according to the account&#39;s plan.</p>
<h2 id='recorded-footage-on-device'>Recorded Footage on Device</h2><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">deviceId</span><span class="p">)[</span><span class="s">"Telemetry"</span><span class="p">][</span><span class="s">"state"</span><span class="p">][</span><span class="s">"afu"</span><span class="p">]</span>

<span class="c"># Output:</span>
<span class="c"># {</span>
<span class="c">#   "queue_duration": 4793,    # The duration of stored footage, in seconds</span>
<span class="c">#   "queue_size": 2513406672,  # The size of stored footage, in bytes</span>
<span class="c">#   "speed": 0,                # Uploading speed (if footage is being uploaded)</span>
<span class="c">#   "state": False             # True if uploading enabled, False otherwise</span>
<span class="c"># }</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span> <span class="se">\</span>
| jq <span class="s1">'.Telemetry.state.afu'</span>

<span class="c"># Output:</span>
<span class="c"># {</span>
<span class="c">#   "queue_duration": 4793,    # The duration of stored footage, in seconds</span>
<span class="c">#   "queue_size": 2513406672,  # The size of stored footage, in bytes</span>
<span class="c">#   "speed": 0,                # Uploading speed (if footage is being uploaded)</span>
<span class="c">#   "state": False             # True if uploading enabled, False otherwise</span>
<span class="c"># }</span>
</code></pre>
<p>Status of recorded, but not uploaded footage is reported in <code>state.afu</code> dictionary of device status.</p>
<h1 id='getting-recordings'>Getting Recordings</h1><h2 id='getting-list-of-uploaded-chunks'>Getting List of Uploaded Chunks</h2><pre class="highlight shell tab-shell"><code>curl https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/thumbnails?from<span class="o">=</span>START&amp;to<span class="o">=</span>END <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer TOKEN"</span>

<span class="c"># Output:</span>
<span class="c"># [</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887235.983,</span>
<span class="c">#    "End": 1546887246.35,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000000.mp4"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887246.383,</span>
<span class="c">#    "End": 1546887256.749,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000001.mp4"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887256.783,</span>
<span class="c">#    "End": 1546887267.016,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000002.mp4"</span>
<span class="c">#   }</span>
<span class="c"># ]</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get_timeline</span><span class="p">(</span><span class="n">DEVICEID</span><span class="p">,</span> <span class="n">START</span><span class="p">,</span> <span class="n">END</span><span class="p">)</span>

<span class="c"># Output:</span>
<span class="c"># [</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887235.983,</span>
<span class="c">#    "End": 1546887246.35,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000000.mp4"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887246.383,</span>
<span class="c">#    "End": 1546887256.749,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000001.mp4"</span>
<span class="c">#   },</span>
<span class="c">#   {</span>
<span class="c">#    "Start": 1546887256.783,</span>
<span class="c">#    "End": 1546887267.016,</span>
<span class="c">#    "Url": "chunks/DEVICEID/v2/video/000003000002.mp4"</span>
<span class="c">#   }</span>
<span class="c"># ]</span>
</code></pre>
<p><code>GET /front/api/v2/devices/DEVICEID/thumbnails?from=START&amp;to=END</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>DEVICEID</td>
<td>The ID of the device to retrieve</td>
</tr>
<tr>
<td>START, STOP</td>
<td>Time range (UNIX timestamps)</td>
</tr>
</tbody></table>
<h2 id='downloading-chunks'>Downloading Chunks</h2><pre class="highlight shell tab-shell"><code>
<span class="c"># Getting url of the first chunk from the range</span>
<span class="nv">url</span><span class="o">=</span><span class="k">$(</span>curl -s <span class="s2">"https://go.epiphancloud.com/front/api/v2/devices/DEVICEID/thumbnails?from=START&amp;to=STOP"</span> <span class="se">\</span>
 -H <span class="s2">"Authorization: Bearer TOKEN"</span> | jq -r .[0].Url<span class="k">)</span>

<span class="c"># Downloading the chunk</span>
curl -o <span class="s1">'/tmp/chunk.mp4'</span> <span class="s2">"https://go.epiphancloud.com/front/api/v2/media/</span><span class="nv">$url</span><span class="s2">"</span> <span class="se">\</span>
 -H <span class="s2">"Authorization: Bearer TOKEN"</span>
</code></pre><pre class="highlight python tab-python"><code>
<span class="c"># Getting url of the first chunk from the range</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">Devices</span><span class="o">.</span><span class="n">get_timeline</span><span class="p">(</span><span class="n">DEVICEID</span><span class="p">,</span> <span class="n">START</span><span class="p">,</span> <span class="n">END</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s">"Url"</span><span class="p">]</span>

<span class="c"># Downloading the chunk</span>
<span class="n">api</span><span class="o">.</span><span class="n">HTTP</span><span class="o">.</span><span class="n">http_download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">"/tmp/chunk.mp4"</span><span class="p">)</span>
</code></pre>
<p><code>GET /front/api/v2/media/URL</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URL</td>
<td>Chunk URL from list of chunks</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
